<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>NotePad - 编辑笔记</title>
    <!-- 引入Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- 引入Font Awesome图标 -->
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    
    <!-- 配置Tailwind CSS自定义主题 -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#2563eb',
                        secondary: '#64748b',
                        success: '#10b981',
                        warning: '#f59e0b',
                        danger: '#ef4444',
                        info: '#3b82f6',
                        category1: '#f472b6',
                        category2: '#60a5fa',
                        category3: '#34d399',
                        category4: '#fbbf24'
                    },
                    fontFamily: {
                        sans: ['Roboto', 'system-ui', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    
    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .editor-toolbar {
                @apply bg-gray-100 border-t border-b border-gray-200 px-4 py-2 flex items-center space-x-4;
            }
            .editor-input {
                @apply w-full border-none outline-none resize-none bg-transparent;
            }
            .category-pill {
                @apply text-xs px-2 py-0.5 rounded-full;
            }
            .toggle-switch {
                @apply relative inline-block w-12 h-6;
            }
            .toggle-switch input {
                @apply opacity-0 w-0 h-0;
            }
            .toggle-slider {
                @apply absolute cursor-pointer top-0 left-0 right-0 bottom-0 bg-gray-300 rounded-full transition-all duration-300 ease-in-out;
            }
            .toggle-slider:before {
                @apply absolute content-[''] h-5 w-5 left-0.5 bottom-0.5 bg-white rounded-full transition-all duration-300 ease-in-out;
                content: '';
                height: 20px;
                width: 20px;
                left: 2px;
                bottom: 2px;
                background-color: white;
                border-radius: 50%;
                transition: 0.3s;
            }
            input:checked + .toggle-slider {
                @apply bg-primary;
            }
            input:checked + .toggle-slider:before {
                @apply transform translate-x-6;
            }
            .no-scrollbar::-webkit-scrollbar {
                display: none;
            }
            .no-scrollbar {
                -ms-overflow-style: none;
                scrollbar-width: none;
            }
        }
    </style>
</head>
<body class="bg-gray-100 font-sans text-gray-800">
    <!-- 顶部工具栏 -->
    <div class="bg-primary text-white p-3 flex justify-between items-center shadow-md sticky top-0 z-10">
        <div class="flex items-center space-x-4">
            <button id="backBtn" class="p-2 rounded-full hover:bg-blue-700 transition-colors">
                <i class="fa fa-arrow-left"></i>
            </button>
            <button id="saveBtn" class="px-4 py-1 rounded-md bg-white text-primary font-medium text-sm hover:bg-gray-100 transition-colors">
                保存
            </button>
        </div>
        <div class="flex space-x-4">
            <button id="categorySelectBtn" class="p-2 rounded-full hover:bg-blue-700 transition-colors">
                <i class="fa fa-folder-o"></i>
            </button>
            <button id="todoToggleBtn" class="p-2 rounded-full hover:bg-blue-700 transition-colors">
                <i class="fa fa-list-ul"></i>
            </button>
            <button id="moreBtn" class="p-2 rounded-full hover:bg-blue-700 transition-colors">
                <i class="fa fa-ellipsis-v"></i>
            </button>
        </div>
    </div>
    
    <!-- 笔记编辑区域 -->
    <div class="bg-white min-h-screen">
        <!-- 标题输入框 -->
        <div class="px-4 py-3 border-b border-gray-100">
            <input 
                type="text" 
                id="noteTitle" 
                placeholder="标题" 
                class="editor-input text-2xl font-bold"
            >
        </div>
        
        <!-- 内容编辑器 -->
        <div class="px-4 py-3">
            <textarea 
                id="noteContent" 
                placeholder="开始输入内容..." 
                class="editor-input min-h-[70vh] text-base leading-relaxed"
            ></textarea>
        </div>
    </div>
    
    <!-- 代办功能区域（默认隐藏） -->
    <div id="todoSection" class="bg-white mt-2 border-t border-b border-gray-200 hidden">
        <div class="p-4">
            <div class="flex items-center justify-between mb-4">
                <h3 class="font-medium">代办设置</h3>
                <label class="toggle-switch">
                    <input type="checkbox" id="isCompletedToggle">
                    <span class="toggle-slider"></span>
                </label>
            </div>
            
            <div class="flex items-center justify-between">
                <div class="flex items-center">
                    <i class="fa fa-bell-o text-gray-400 mr-3"></i>
                    <span class="text-gray-600">提醒时间</span>
                </div>
                <button id="setReminderBtn" class="text-primary flex items-center">
                    设置 <i class="fa fa-chevron-right ml-2 text-xs text-gray-400"></i>
                </button>
            </div>
        </div>
    </div>
    
    <!-- 底部信息 -->
    <div class="p-4 text-center text-gray-400 text-xs">
        <p id="lastModifiedTime">上次修改: 2023-06-15 14:30:22</p>
    </div>
    
    <!-- 分类选择浮层 -->
    <div id="categorySelectModal" class="fixed inset-0 bg-black/50 z-50 hidden flex items-end justify-center">
        <div class="bg-white rounded-t-lg w-full max-w-sm shadow-xl transform transition-transform duration-300 ease-in-out" style="transform: translateY(100%);">
            <div class="p-4 border-b border-gray-200 flex justify-between items-center">
                <h3 class="text-lg font-bold">选择分类</h3>
                <button id="closeCategorySelectModal" class="p-1 text-gray-500 hover:text-gray-700">
                    <i class="fa fa-times"></i>
                </button>
            </div>
            <div class="p-4 max-h-80 overflow-y-auto">
                <div class="space-y-3">
                    <div class="flex items-center p-2 hover:bg-gray-50 rounded">
                        <div class="w-3 h-3 rounded-full bg-gray-300 mr-3"></div>
                        <span>未分类</span>
                    </div>
                    <div class="flex items-center p-2 hover:bg-gray-50 rounded">
                        <div class="w-3 h-3 rounded-full bg-category1 mr-3"></div>
                        <span>工作</span>
                    </div>
                    <div class="flex items-center p-2 hover:bg-gray-50 rounded">
                        <div class="w-3 h-3 rounded-full bg-category2 mr-3"></div>
                        <span>学习</span>
                    </div>
                    <div class="flex items-center p-2 hover:bg-gray-50 rounded">
                        <div class="w-3 h-3 rounded-full bg-category3 mr-3"></div>
                        <span>生活</span>
                    </div>
                    <div class="flex items-center p-2 hover:bg-gray-50 rounded">
                        <div class="w-3 h-3 rounded-full bg-category4 mr-3"></div>
                        <span>旅行</span>
                    </div>
                </div>
            </div>
            <div class="p-4 border-t border-gray-200">
                <button id="manageCategoriesBtn" class="w-full py-2 bg-gray-100 text-primary rounded-lg font-medium hover:bg-gray-200 transition-colors">
                    <i class="fa fa-cog mr-2"></i>管理分类
                </button>
            </div>
        </div>
    </div>
    
    <!-- 提醒时间设置浮层 -->
    <div id="reminderModal" class="fixed inset-0 bg-black/50 z-50 hidden flex items-end justify-center">
        <div class="bg-white rounded-t-lg w-full max-w-sm shadow-xl transform transition-transform duration-300 ease-in-out" style="transform: translateY(100%);">
            <div class="p-4 border-b border-gray-200 flex justify-between items-center">
                <h3 class="text-lg font-bold">设置提醒时间</h3>
                <button id="closeReminderModal" class="p-1 text-gray-500 hover:text-gray-700">
                    <i class="fa fa-times"></i>
                </button>
            </div>
            <div class="p-4">
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-1">日期</label>
                    <input type="date" id="reminderDate" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50">
                </div>
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-1">时间</label>
                    <input type="time" id="reminderTime" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50">
                </div>
                <div class="flex items-center mb-4">
                    <input type="checkbox" id="repeatReminder" class="w-4 h-4 text-primary focus:ring-primary border-gray-300 rounded">
                    <label for="repeatReminder" class="ml-2 text-sm text-gray-700">重复提醒</label>
                </div>
                <div class="hidden" id="repeatOptions">
                    <label class="block text-sm font-medium text-gray-700 mb-1">重复频率</label>
                    <select class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50">
                        <option>每天</option>
                        <option>每周</option>
                        <option>每月</option>
                        <option>每年</option>
                    </select>
                </div>
            </div>
            <div class="p-4 border-t border-gray-200 flex space-x-3">
                <button id="cancelReminderBtn" class="flex-1 py-2 border border-gray-300 rounded-lg font-medium hover:bg-gray-50 transition-colors">取消</button>
                <button id="confirmReminderBtn" class="flex-1 py-2 bg-primary text-white rounded-lg font-medium hover:bg-blue-700 transition-colors">确定</button>
            </div>
        </div>
    </div>
    
    <!-- 更多选项浮层 -->
    <div id="moreOptionsModal" class="fixed inset-0 bg-black/50 z-50 hidden flex items-end justify-center">
        <div class="bg-white rounded-t-lg w-full max-w-sm shadow-xl transform transition-transform duration-300 ease-in-out" style="transform: translateY(100%);">
            <div class="p-4 border-b border-gray-200">
                <h3 class="text-lg font-bold text-center">更多选项</h3>
            </div>
            <div class="divide-y divide-gray-100">
                <button class="w-full py-3 flex items-center text-gray-700 hover:bg-gray-50">
                    <i class="fa fa-text-height w-8 text-center text-primary"></i>
                    <span>字体大小</span>
                </button>
                <button class="w-full py-3 flex items-center text-gray-700 hover:bg-gray-50">
                    <i class="fa fa-paint-brush w-8 text-center text-primary"></i>
                    <span>主题设置</span>
                </button>
                <button class="w-full py-3 flex items-center text-gray-700 hover:bg-gray-50">
                    <i class="fa fa-share-alt w-8 text-center text-primary"></i>
                    <span>分享笔记</span>
                </button>
                <button class="w-full py-3 flex items-center text-gray-700 hover:bg-gray-50">
                    <i class="fa fa-download w-8 text-center text-primary"></i>
                    <span>导出笔记</span>
                </button>
                <button class="w-full py-3 flex items-center text-danger hover:bg-gray-50">
                    <i class="fa fa-trash w-8 text-center"></i>
                    <span>删除笔记</span>
                </button>
            </div>
            <div class="p-4">
                <button id="closeMoreOptionsModal" class="w-full py-2 bg-gray-100 rounded-lg font-medium hover:bg-gray-200 transition-colors">
                    取消
                </button>
            </div>
        </div>
    </div>
    
    <!-- JavaScript交互逻辑 -->
    <script>
        // 返回按钮点击事件
        document.getElementById('backBtn').addEventListener('click', function() {
            // 检查是否有未保存的更改
            if (document.getElementById('noteTitle').value || document.getElementById('noteContent').value) {
                if (confirm('是否保存当前更改？')) {
                    saveNote();
                }
            }
            window.location.href = 'notes_list.html';
        });
        
        // 保存按钮点击事件
        document.getElementById('saveBtn').addEventListener('click', saveNote);
        
        function saveNote() {
            const title = document.getElementById('noteTitle').value;
            const content = document.getElementById('noteContent').value;
            
            if (!title.trim()) {
                alert('请输入标题');
                return;
            }
            
            // 更新最后修改时间
            const now = new Date();
            const formattedDate = now.getFullYear() + '-' + 
                                 String(now.getMonth() + 1).padStart(2, '0') + '-' + 
                                 String(now.getDate()).padStart(2, '0') + ' ' + 
                                 String(now.getHours()).padStart(2, '0') + ':' + 
                                 String(now.getMinutes()).padStart(2, '0') + ':' + 
                                 String(now.getSeconds()).padStart(2, '0');
            
            document.getElementById('lastModifiedTime').textContent = '上次修改: ' + formattedDate;
            
            alert('笔记保存成功！');
        }
        
        // 代办切换按钮点击事件
        document.getElementById('todoToggleBtn').addEventListener('click', function() {
            const todoSection = document.getElementById('todoSection');
            todoSection.classList.toggle('hidden');
            
            // 切换图标样式
            const icon = this.querySelector('i');
            if (todoSection.classList.contains('hidden')) {
                icon.classList.remove('text-warning');
            } else {
                icon.classList.add('text-warning');
            }
        });
        
        // 分类选择按钮点击事件
        document.getElementById('categorySelectBtn').addEventListener('click', function() {
            openModal('categorySelectModal');
        });
        
        // 设置提醒按钮点击事件
        document.getElementById('setReminderBtn').addEventListener('click', function() {
            openModal('reminderModal');
        });
        
        // 更多选项按钮点击事件
        document.getElementById('moreBtn').addEventListener('click', function() {
            openModal('moreOptionsModal');
        });
        
        // 关闭分类选择浮层
        document.getElementById('closeCategorySelectModal').addEventListener('click', function() {
            closeModal('categorySelectModal');
        });
        
        // 关闭提醒时间浮层
        document.getElementById('closeReminderModal').addEventListener('click', function() {
            closeModal('reminderModal');
        });
        
        // 关闭更多选项浮层
        document.getElementById('closeMoreOptionsModal').addEventListener('click', function() {
            closeModal('moreOptionsModal');
        });
        
        // 取消提醒设置
        document.getElementById('cancelReminderBtn').addEventListener('click', function() {
            closeModal('reminderModal');
        });
        
        // 确认提醒设置
        document.getElementById('confirmReminderBtn').addEventListener('click', function() {
            const date = document.getElementById('reminderDate').value;
            const time = document.getElementById('reminderTime').value;
            
            if (!date || !time) {
                alert('请设置完整的日期和时间');
                return;
            }
            
            alert('提醒时间设置成功！');
            closeModal('reminderModal');
        });
        
        // 管理分类按钮点击事件
        document.getElementById('manageCategoriesBtn').addEventListener('click', function() {
            closeModal('categorySelectModal');
            window.location.href = 'category_manager.html';
        });
        
        // 重复提醒复选框事件
        document.getElementById('repeatReminder').addEventListener('change', function() {
            const repeatOptions = document.getElementById('repeatOptions');
            repeatOptions.classList.toggle('hidden');
        });
        
        // 选择分类项事件
        const categoryItems = document.querySelectorAll('#categorySelectModal .flex.items-center');
        categoryItems.forEach(item => {
            item.addEventListener('click', function() {
                // 移除所有选中状态
                categoryItems.forEach(i => i.classList.remove('bg-blue-50'));
                // 添加当前选中状态
                this.classList.add('bg-blue-50');
                // 更新分类按钮图标样式
                const categoryColor = this.querySelector('div').style.backgroundColor;
                const categoryBtn = document.getElementById('categorySelectBtn');
                if (categoryColor !== 'rgb(209, 213, 219)') { // 不是未分类
                    categoryBtn.querySelector('i').classList.add('fa-folder');
                    categoryBtn.querySelector('i').classList.remove('fa-folder-o');
                }
                // 关闭浮层
                setTimeout(() => closeModal('categorySelectModal'), 200);
            });
        });
        
        // 打开浮层函数
        function openModal(modalId) {
            const modal = document.getElementById(modalId);
            modal.classList.remove('hidden');
            setTimeout(() => {
                modal.querySelector('div').style.transform = 'translateY(0)';
            }, 10);
        }
        
        // 关闭浮层函数
        function closeModal(modalId) {
            const modal = document.getElementById(modalId);
            modal.querySelector('div').style.transform = 'translateY(100%)';
            setTimeout(() => {
                modal.classList.add('hidden');
            }, 300);
        }
        
        // 设置默认日期和时间为当前时间
        const now = new Date();
        const formattedDate = now.getFullYear() + '-' + 
                             String(now.getMonth() + 1).padStart(2, '0') + '-' + 
                             String(now.getDate()).padStart(2, '0');
        const formattedTime = String(now.getHours()).padStart(2, '0') + ':' + 
                             String(now.getMinutes()).padStart(2, '0');
        
        document.getElementById('reminderDate').value = formattedDate;
        document.getElementById('reminderTime').value = formattedTime;
    </script>
</body>
</html>