# NotePad应用功能升级PRD

## 1. 产品概述

### 1.1 产品背景
基于现有的Android原生NotePad应用，进行功能升级，增加用户体验优化和实用功能扩展。

### 1.2 产品目标
- 提升笔记管理效率
- 增强用户对笔记内容的查找能力
- 支持笔记分类管理
- 增加代办事项管理功能

## 2. 功能需求

### 2.1 基本功能

#### 2.1.1 笔记列表时间戳显示
- 在笔记列表界面（NotesList）中，每条笔记条目下方增加修改时间显示
- 时间格式：YYYY-MM-DD HH:mm:SS
- 时间显示位置在标题下方，字体颜色稍浅，字号略小

#### 2.1.2 笔记查询功能
- 在笔记列表界面顶部增加搜索框
- 搜索支持按标题或内容模糊匹配
- 实时搜索结果显示
- 清空搜索框后恢复完整笔记列表
- 无搜索结果时显示提示信息

### 2.2 附加功能

#### 2.2.1 笔记分类功能
- 新增分类管理页面
- 支持创建、编辑、删除分类
- 每个分类可设置名称和颜色标识
- 笔记创建和编辑时可选择分类
- 笔记列表界面可按分类筛选显示
- 支持批量修改笔记分类
- 新增分类表结构，与笔记表关联

#### 2.2.2 代办功能
- 在笔记编辑界面增加代办事项切换开关
- 代办笔记支持设置完成状态（未完成/已完成）
- 代办笔记在列表中有特殊标识
- 支持按完成状态筛选代办笔记
- 完成的代办笔记可显示划线效果
- 支持设置代办提醒时间
- 新增代办状态和提醒时间字段到笔记表

## 3. 技术实现方案

### 3.1 数据结构修改

#### 3.1.1 数据库表结构扩展
- 修改notes表，增加以下字段：
  - `category_id`：分类ID，外键关联categories表
  - `is_todo`：是否为代办事项（0/1）
  - `is_completed`：代办完成状态（0/1）
  - `reminder_time`：提醒时间戳
- 新增categories表，包含字段：
  - `_id`：分类ID（主键）
  - `name`：分类名称
  - `color`：分类颜色值
  - `created_date`：创建时间

#### 3.1.2 ContentProvider更新
- 更新NotePadProvider以支持新增字段的CRUD操作
- 扩展URI模式以支持分类相关操作
- 修改查询方法以支持搜索、分类筛选和代办状态筛选

### 3.2 界面修改

#### 3.2.1 NotesList界面
- 修改列表项布局，添加时间戳显示
- 增加搜索框组件和搜索逻辑
- 添加分类筛选下拉菜单
- 为代办笔记添加特殊标识（复选框和状态指示）
- 修改适配器以支持新的数据字段显示

#### 3.2.2 NoteEditor界面
- 添加分类选择器（下拉菜单或弹出窗口）
- 增加代办事项切换开关
- 完成状态切换按钮
- 提醒时间设置控件
- 保存逻辑更新以包含新字段

#### 3.2.3 新增CategoryManager界面
- 分类列表显示
- 添加、编辑、删除分类的操作按钮
- 分类颜色选择器

### 3.3 现有代码修改点

#### 3.3.1 NotePad.java
- 增加新的URI常量和MIME类型定义
- 扩展Notes内部类，添加新字段常量
- 新增Categories内部类定义

#### 3.3.2 NotesList.java
- 修改PROJECTION数组，包含时间戳和新增字段
- 增加搜索框初始化和搜索逻辑
- 修改列表适配器以支持新的数据绑定
- 添加分类筛选和代办状态筛选逻辑

#### 3.3.3 NotePadProvider.java
- 更新DatabaseHelper的onCreate和onUpgrade方法
- 修改query方法以支持搜索、分类和代办状态过滤
- 更新insert、update方法以支持新字段
- 添加categories表的CRUD操作

#### 3.3.4 NoteEditor.java
- 修改PROJECTION数组，包含新字段
- 添加分类选择UI和处理逻辑
- 添加代办相关UI和处理逻辑
- 更新保存逻辑以包含新字段

## 4. 用户体验设计

### 4.1 交互流程
- **搜索流程**：用户在搜索框输入关键词 -> 实时显示匹配结果
- **分类操作流程**：进入分类管理 -> 创建/编辑/删除分类 -> 应用到笔记
- **代办管理流程**：创建或编辑笔记 -> 开启代办模式 -> 设置完成状态和提醒时间

### 4.2 视觉设计
- 保持与原生Android风格一致
- 分类使用不同颜色标识，增强可识别性
- 代办笔记使用复选框明确表示状态
- 完成的代办事项标题显示划线效果

## 5. 性能与兼容性

### 5.1 性能优化
- 搜索功能使用异步加载，避免阻塞UI
- 大量笔记场景下优化列表加载效率
- 数据库查询添加索引以提升搜索性能

### 5.2 兼容性要求
- 支持Android 4.0及以上版本
- 适配不同屏幕尺寸
- 确保在低配置设备上流畅运行

## 6. 测试要点

### 6.1 功能测试
- 时间戳显示格式和更新逻辑验证
- 搜索功能的准确性和实时性
- 分类的增删改查及与笔记的关联
- 代办功能的状态切换和提醒功能

### 6.2 性能测试
- 大数据量（1000+笔记）下的搜索响应时间
- 列表滚动流畅度
- 数据库操作的执行效率

## 7. 实施计划

### 7.1 开发阶段
1. 数据库结构修改
2. ContentProvider更新
3. 基本功能实现（时间戳显示、搜索）
4. 附加功能实现（分类、代办）
5. UI整合和用户体验优化

### 7.2 测试阶段
1. 单元测试
2. 集成测试
3. 用户体验测试
4. 性能测试

### 7.3 部署阶段
1. 构建发布版本
2. 版本发布

## 8. 风险评估

### 8.1 潜在风险
- 数据库升级可能导致数据丢失
- 大量笔记场景下搜索性能下降
- 提醒功能在不同Android版本上表现可能不一致

### 8.2 缓解措施
- 实现数据库升级迁移脚本，确保数据安全
- 优化搜索算法和数据库索引
- 针对不同Android版本进行兼容性测试